alias powerview {
    local('$command @args $argu $powerview_loaded');

    $powerview_loaded = bpowerpick!($1, "Get-Module -Name PowerView | select Name");

    if ($powerview_loaded =~ "PowerView") {
        btask($1, "PowerView is already imported.");
    } else {
        # Import powerview
        bpowershell_import($1, "C:\\Tools\\PowerSploit\\Recon\\PowerView.ps1");
        sleep(2000);
    }

    $desc = "Powerview";

    @args = @_;
    remove(@args, $bid);
    $argu = join(' ', @args);

    if ($argu eq ""){
        blog2($bid, "" . dstamp(ticks()) . " Executing $desc");
    }
    else{
        blog2($bid, "" . dstamp(ticks()) . " Executing $desc \'$argu\'");
    }

    # Execute the provided PowerView command using powerpick
    bpowerpick!($1, $argu);
    bpowerpick(beacon, cmdlet, [script])
}

# Register the custom command
beacon_command_register(
    "powerview", 
    "Execute PowerView commands", 
    "Runs the specified PowerView command after ensuring it's imported."
);
